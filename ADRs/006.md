# ADR.006 — Reranking leve + política de evidências

## Context and Problem Statement

Mesmo com per-number, há empates ou "vizinhos semânticos" (súmulas parecidas). Queremos ordenação mais estável no top-N e melhor seleção de evidências (o que entregar à LLM).

## Decision Drivers

- Melhorar precisão do top-1/3 sem custo alto
- Mantê-lo simples de operar (modelo pequeno)
- Evidências legíveis e rastreáveis (IDs e seções)

## Considered Options

- Só dense retrieval (sem reranker)
- **Cross-encoder pequeno (reranker) no top-N** ✅
- Reranker pesado (grande custo)

## Decision Outcome

- **Reranker:** mixedbread-ai/mxbai-rerank-xsmall-v1 (multilíngue, rápido)
- **Entrada:** pares (query, enunciado) — fallback: primeiro excerto
- **Top-K final:** k pequeno (p.ex. 5) para compor prompt
- **Evidências:** priorizar enunciado, depois 1–2 excertos curtos com [chunk_id]; incluir referência do precedente quando detectável

## Consequences

- Aumenta segurança do top-1 em casos ambíguos
- Mais explicabilidade (enunciado primeiro; excertos com origem)

## Risks & Mitigations

- **Risco:** Custo extra, mas pequeno (top-5 pairs)
- **Mitigação:** Se indisponível, degrada graciosamente para dense-only
